{% extends "baselayout.html" %}
{% load bootstrap3 %}
{% load i18n %}
{# Translators: Title for sign search page #}
{% block bootstrap3_title %}{% blocktrans %}Signbank: Search Signs{% endblocktrans %}{% endblock %}
{% block extrahead %}
{% endblock %}

{% block extrajs %}

    <script type="text/javascript" src="{{ STATIC_URL }}js/typeahead.bundle.min.js"></script>

    <script type='text/javascript'>
    
    
    $(document).ready(function(){
        
        
        $('.collapsetoggle').click(function() {
            if ($(this).text() == 'Show') {
                $(this).text('Hide');
            } else {
                $(this).text('Show');
            }
        });
        
        
    });



// http://www.javascript-coder.com/javascript-form/javascript-reset-form.phtml
function clearForm(myFormElement) {

  var elements = myFormElement.elements;

  myFormElement.reset();

  for(i=0; i<elements.length; i++) {

      field_type = elements[i].type.toLowerCase();
    
      switch(field_type) {
    
        case "text":
        case "password":
        case "textarea":
        case "hidden":
    
          elements[i].value = "";
          break;
    
        case "radio":
        case "checkbox":
            if (elements[i].checked) {
              elements[i].checked = false;
          }
          break;
    
        case "select-one":
        case "select-multiple":
                    elements[i].selectedIndex = -1;
          break;
    
        default:
          break;
      }
    }
    return(false);
}
   </script>
{% endblock %}


{% block content %}


<div id='searchformwell' class='well'>
    <form name='adminsearch' id='adminsearch'>
        
        <div>
            <table class='table' id='searchfields'>
                <tr>
                    <td><div class='input-group'>
                        <label class='input-group-addon' for='id_annotation_idgloss_jkl'>{{searchform.search.label}}</label>
                        <input name='search' class='form-control' {% if searchform.search.value %}value='{{searchform.search.value}}'{% endif %}></div>
                    </td>
                    <td><div class='input-group'>
                        <label class='input-group-addon' for='id_annotation_idgloss_jkl_en'>{{searchform.JKLenglishGloss.label}}</label>
                        <input name='JKLenglishGloss' class='form-control' {% if searchform.JKLenglishGloss.value %}value='{{searchform.JKLenglishGloss.value}}'{% endif %}></div>
                    </td>
                    <td><div class='input-group'>
                        <label class='input-group-addon' for='id_annotation_idgloss_hki'>{{searchform.HKIGloss.label}}</label>
                        <input name='HKIGloss' class='form-control' {% if searchform.HKIGloss.value %}value='{{searchform.HKIGloss.value}}'{% endif %}></div>
                    </td>
                    <td><div class='input-group'>
                        <label class='input-group-addon' for='id_annotation_idgloss_hki_en'>{{searchform.HKIenglishGloss.label}}</label>
                        <input name='HKIenglishGloss' class='form-control' {% if searchform.HKIenglishGloss.value %}value='{{searchform.HKIenglishGloss.value}}'{% endif %}></div>
                    </td>
                    <td><div class='input-group'>
                        <label class='input-group-addon' for='id_keyword'>{{searchform.keyword.label}}</label>
                        <input name='keyword' class='form-control' {% if searchform.keyword.value %}value='{{searchform.keyword.value}}'{% endif %}></div>
                    </td>
                </tr>
            </table>
        </div>

        <div class="panel-group">
            <div  class="panel panel-default">
                {# Translators: Search by language #}
                <div class="panel-heading" data-toggle="collapse" data-target="#searchpanels">{% blocktrans %}Search by Language and Basic Properties{% endblocktrans %}</div>

                <div id='searchpanels' class='collapse'>
                <table class='table'>
                      <tr>
                        <td>
                            <div class='input-group'>
                                <label class='input-group-addon' for='id_language'>{{searchform.language.label}}</label>
                                {{searchform.language}}
                            </div>
                        </td>
                        <td>
                            <div class='input-group'>
                                <label class='input-group-addon' for='id_dialect'>{{searchform.dialect.label}}</label>
                                {{searchform.dialect}}
                            </div>
                        </td>
                      </tr>

                </table>

                <table class='table'>
                    <tr><td><label for='id_annotation_comments'>{{searchform.annotation_comments.label}}</label></td><td>{{searchform.annotation_comments}}</td></tr>
                </table>

                </div>
              </div>

            <div  class="panel panel-default">
              {# Translators: Search by morphology #}
              <div class="panel-heading" data-toggle="collapse" data-target="#morph_search">{% blocktrans %}Search by Morphology{% endblocktrans %}</div>

              <div id='morph_search' class='collapse'>
              <table class='table table-condensed'>
                <tr>

                  <td>
                    <table class='table table-condensed'>
                        <tr><td><label for='id_handedness'>{{searchform.morpheme.label}}</label></td><td>{{searchform.morpheme}}</td></tr>
                        <tr><td><label for='id_strong_handshape'>{{searchform.hasMorphemeOfType.label}}</label></td><td>{{searchform.hasMorphemeOfType}}</td></tr>
                    </table>

                  </td>
                </tr>
              </table>
              </div>
            </div>

            <div  class="panel panel-default">
              {# Translators: Search by phonology #}
              <div class="panel-heading" data-toggle="collapse" data-target="#phon_search">{% blocktrans %}Search by Phonology{% endblocktrans %}</div>

              <div id='phon_search' class='collapse'>
              <table class='table table-condensed'>
                <tr>

                  <td>
                    <table class='table table-condensed'>
                        <tr><td><label for='id_handedness'>{{searchform.handedness.label}}</label></td><td>{{searchform.handedness}}</td></tr>
                        <tr><td><label for='id_strong_handshape'>{{searchform.strong_handshape.label}}</label></td><td>{{searchform.strong_handshape}}</td></tr>
                        <tr><td><label for='id_weak_handshape'>{{searchform.weak_handshape.label}}</label></td><td>{{searchform.weak_handshape}}</td></tr>
                        <tr><td><label for='id_handshape_change'>{{searchform.handshape_change.label}}</label></td><td>{{searchform.handshape_change}}</td></tr>

                        <tr><td><label for='id_relation_between_articulators'>{{searchform.relation_between_articulators.label}}</label></td><td>{{searchform.relation_between_articulators}}</td></tr>
                        <tr><td><label for='id_location'>{{searchform.location.label}}</label></td><td>{{searchform.location}}</td></tr>

                        <tr><td><label for='id_absolute_orientation_palm'>{{searchform.absolute_orientation_palm.label}}</label></td><td>{{searchform.absolute_orientation_palm}}</td></tr>
                        <tr><td><label for='id_absolute_orientation_fingers'>{{searchform.absolute_orientation_fingers.label}}</label></td><td>{{searchform.absolute_orientation_fingers}}</td></tr>
                        <tr><td><label for='id_relative_orientation_movement'>{{searchform.relative_orientation_movement.label}}</label></td><td>{{searchform.relative_orientation_movement}}</td></tr>
                        <tr><td><label for='id_relative_orientation_location'>{{searchform.relative_orientation_location.label}}</label></td><td>{{searchform.relative_orientation_location}}</td></tr>
                        <tr><td><label for='id_orientation_change'>{{searchform.orientation_change.label}}</label></td><td>{{searchform.orientation_change}}</td></tr>

                        <tr><td><label for='id_contact_type'>{{searchform.contact_type.label}}</label></td><td>{{searchform.contact_type}}</td></tr>
                        <tr><td><label for='id_movement_shape'>{{searchform.movement_shape.label}}</label></td><td>{{searchform.movement_shape}}</td></tr>
                        <tr><td><label for='id_movement_direction'>{{searchform.movement_direction.label}}</label></td><td>{{searchform.movement_direction}}</td></tr>
                        <tr><td><label for='id_movement_manner'>{{searchform.movement_manner.label}}</label></td><td>{{searchform.movement_manner}}</td></tr>
                        <tr><td><label for='id_repeated_movement'>{{searchform.repeated_movement.label}}</label></td><td>{{searchform.repeated_movement}}</td></tr>
                        <tr><td><label for='id_alternating_movement'>{{searchform.alternating_movement.label}}</label></td><td>{{searchform.alternating_movement}}</td></tr>

                        <tr><td><label for='id_phonology_other'>{{searchform.phonology_other.label}}</label></td><td>{{searchform.phonology_other}}</td></tr>
                        <tr><td><label for='id_mouth_gesture'>{{searchform.mouth_gesture.label}}</label></td><td>{{searchform.mouth_gesture}}</td></tr>
                        <tr><td><label for='id_mouthing'>{{searchform.mouthing.label}}</label></td><td>{{searchform.mouthing}}</td></tr>
                        <tr><td><label for='id_phonetic_variation'>{{searchform.phonetic_variation.label}}</label></td><td>{{searchform.phonetic_variation}}</td></tr>

                    </table>

                  </td>
                </tr>
              </table>
              </div>
            </div>

            <div  class="panel panel-default">
              {# Translators: Search by semantics #}
              <div class="panel-heading" data-toggle="collapse" data-target="#sem_search">{% blocktrans %}Search by Semantics{% endblocktrans %}</div>

              <div id='sem_search' class='collapse'>
              <table class='table table-condensed'>
                <tr>

                  <td>
                    <table class='table table-condensed'>
                        <tr><td><label for='id_iconic_image'>{{searchform.iconic_image.label}}</label></td><td>{{searchform.iconic_image}}</td></tr>
                        <tr><td><label for='id_named_entity'>{{searchform.named_entity.label}}</label></td><td>{{searchform.named_entity}}</td></tr>
                        <tr><td><label for='id_semantic_field'>{{searchform.semantic_field.label}}</label></td><td>{{searchform.semantic_field}}</td></tr>

                    </table>

                  </td>
                </tr>
              </table>
              </div>
            </div>

            <div  class="panel panel-default">
              {# Translators: Search by relation #}
              <div class="panel-heading" data-toggle="collapse" data-target="#rel_search">{% blocktrans %}Search by Relation{% endblocktrans %}</div>

              <div id='rel_search' class='collapse'>
              <table class='table'>
                <tr>

                      <tr>
                        <td>
                            <div class='input-group'>
                                <label class='input-group-addon' for='id_relation'>{{searchform.relation.label}}</label>
                                {{searchform.relation}}
                            </div>
                        </td>
                        <td>
                            <div class='input-group'>
                                <label class='input-group-addon' for='id_hasRelation'>{{searchform.hasRelation.label}}</label>
                                {{searchform.hasRelation}}
                            </div>
                        </td>
                      </tr>

                      <tr>
                        <td>
                            <div class='input-group'>
                                <label class='input-group-addon' for='id_relationToForeignSign'>{{searchform.relationToForeignSign.label}}</label>
                                {{searchform.relationToForeignSign}}
                            </div>
                        </td>

                        <td>
                            <div class='input-group'>
                                <label class='input-group-addon' for='id_hasRelationToForeignSign'>{{searchform.hasRelationToForeignSign.label}}</label>
                                {{searchform.hasRelationToForeignSign}}
                            </div>
                        </td>

                      </tr>


                </tr>
              </table>
              </div>
            </div>

            <div  class="panel panel-default">
              {# Translators: Search by publication status and notes #}
              <div class="panel-heading" data-toggle="collapse" data-target="#pub_search">{% blocktrans %}Search by Publication Status and Notes{% endblocktrans %}</div>

              <div id='pub_search' class='collapse'>
              <table class='table'>
                <tr>

                      <tr>
                        <td>
                            <div class='input-group'>
                                <label class='input-group-addon' for='id_in_web_dictionary'>{{searchform.in_web_dictionary.label}}</label>
                                {{searchform.in_web_dictionary}}
                            </div>
                        </td>
                        <td>
                            <div class='input-group'>
                                <label class='input-group-addon' for='id_is_proposed_new_sign'>{{searchform.is_proposed_new_sign.label}}</label>
                                {{searchform.is_proposed_new_sign}}
                            </div>
                        </td>
                      </tr>

                      <tr>
                        <td>
                            <div class='input-group'>
                                <label class='input-group-addon' for='id_definitionRole'>{{searchform.definitionRole.label}}</label>
                                {{searchform.definitionRole}}
                            </div>
                        </td>
                        <td>
                            <div class='input-group'>
                                <label class='input-group-addon' for='id_definitionContains'>{{searchform.definitionContains.label}}</label>
                                {{searchform.definitionContains}}
                            </div>
                        </td>
                      </tr>


                </tr>
              </table>
              </div>
            </div>
        </div>

        <div class='btn-group'>
            <input class='btn btn-primary' type='submit' name='submit' value='Search'>
            {% if perms.dictionary.export_csv %}
            <input class='btn btn-default' type='submit' name='format' value='CSV'>
            {% endif %}
            <input class='btn btn-default' type='submit' onclick="clearForm(document.adminsearch);" value='Reset'>
        </div>

        <div class='form-group' id='paginate_by'>
        {# Translators: How many results to fit per page  #}
        <label for='paginate_by'>{% blocktrans %}Results per page{% endblocktrans %}</label>
        <select class='form-control' name="paginate_by">
            <option>3000</option>
            <option>2000</option>
            <option>1000</option>
            <option>500</option>
          <option>100</option>
            <option>50</option>
            <option>25</option>
            <option>10</option>
        </select>
        </div>


    </form>

</div>

   {% if perms.dictionary.add_gloss %}
   <div  class="panel panel-default">
      {# Translators: Button #}
      <div class="panel-heading" data-toggle="collapse"  data-target='#add_gloss_form'>{% blocktrans %}Add New Sign{% endblocktrans %}</div>

         <div id='add_gloss_form' class='collapse'>
             <form action='{% url "dictionary:add_gloss" %}' method='post'>
                 {% csrf_token %}
                 <table class='table'>
                     <tr>
                         {# Translators: Field label #}
                         <th><label for='id_idgloss'>{% blocktrans %}Gloss{% endblocktrans %}</label></th>
                         {# Translators: Field label #}
                         <th><label for='id_annotation_idgloss_jkl'>{% blocktrans %}Gloss JKL{% endblocktrans %}</label></th>
                         {# Translators: Field label  #}
                         <th><label for='id_annotation_idgloss_jkl_en'>{% blocktrans %}Gloss JKL English{% endblocktrans %}</label></th>
                         {# Translators: Field label  #}
                         <th><label for='id_annotation_idgloss_hki'>{% blocktrans %}Gloss HKI{% endblocktrans %}</label></th>
                         {# Translators: Field label  #}
                         <th><label for='id_annotation_idgloss_hki_en'>{% blocktrans %}Gloss HKI English{% endblocktrans %}</label></th>
                         <th></th>
                     </tr>
                     <tr>
                         <td>{{add_gloss_form.idgloss}}</td>
                         <td>{{add_gloss_form.annotation_idgloss_jkl}}</td>
                         <td>{{add_gloss_form.annotation_idgloss_jkl_en}}</td>
                         <td>{{add_gloss_form.annotation_idgloss_hki}}</td>
                         <td>{{add_gloss_form.annotation_idgloss_hki_en}}</td>
                         {# Translators: Button #}
                         <td><input class='btn btn-primary' type='submit' value='{% blocktrans %}Add New Sign{% endblocktrans %}'></td>
                     </tr>
                 </table>
                 
             </form>
         </div>
      </div>
      {% endif %}
                
             
             

  
{# Translators: How many matches out of possible  #}
<p>{% blocktrans %}Number of matches: {{page_obj.paginator.count}} out of {{glosscount}}{% endblocktrans %}.</p>

{% if object_list %}
<table class='table table-condensed'>
    <thead>
      <tr>
         {% for name, value in object_list.0.admin_fields %}

           {# It seems like this if-clause inserts translation equivalents in the gloss list #}
           {# The number in the forloop counter means where to insert the table title for these fields #}
           {% if forloop.counter == 4 %}
               {# This inserts the desired name for the table label #}
               <th>{{ name }}</th><th>{% blocktrans %}Translation equivalents{% endblocktrans %}</th>
		   {% else %}
               <th>{{ name }}</th>
		   {% endif %}
		   
         {% endfor %}
           <th>Tags</th>
      </tr>
    </thead>
    <tbody>
    {% for gloss in object_list %}
        <tr>		
            {% for name, value in gloss.admin_fields %}
                {# This forloop.counter adds links to first columns #}
                {% if forloop.first %}
                    <td><a href="/dictionary/gloss/{{gloss.pk}}/">{{value}}</a></td>

                {# This forloop.counter adds links to desired columns #}
                {% elif forloop.counter == 3 %}
                    <td><a href="/dictionary/gloss/{{gloss.pk}}/">{{value}}</a></td>

                {# This forloop.counter adds regular values, and then adds after them translation equiv values #}
                {% elif forloop.counter == 4 %}
                    <td>{{ value }}</td>
                    <td>
                    {% for translation in gloss.translation_set.all %}
                        {{ translation.translation }}
                    {% endfor %}
                    </td>

                {% else %}
                    <td>{{ value }}</td>
                {% endif %}
            {% endfor %}

    <td>{% for tag in gloss.tags %}<span class='tag'>{{tag}}</span> {% endfor %}</td>
            
        </tr>
    {% endfor %}
  </tbody>
</table>

<div class="pagination">
    <span class="step-links">

        <ul class='pagination pagination-sm'>
        {% if page_obj.has_previous %}
            <li><a href="?page={{ page_obj.previous_page_number }}{% for key,value in request.GET.items %}{% ifnotequal key 'page' %}&{{ key }}={{ value }}{% endifnotequal %}{% endfor %}">&laquo;</a></li>
        {% endif %}
          
          {% if  page_obj.number > 10 %}
            <li><a>...</a></li>
          {% endif %}

          {% for p in page_obj.paginator.page_range %}
          
             {% if p < page_obj.number|add:"10" and  p > page_obj.number|add:"-10" %}
             <li {% ifequal p page_obj.number %}class='active'{% endifequal %}>
             <a href='?page={{ p }}{% for key,value in request.GET.items %}{% ifnotequal key 'page' %}&{{ key }}={{ value }}{% endifnotequal %}{% endfor %}'>{% ifequal p 0 %}Start{% else %}{{p}}{% endifequal %}</a>
             </li>
             {% endif %}
         
          {% endfor %}
  
          {% if page_obj.paginator.num_pages > page_obj.number|add:"10" %}
            <li><a>...</a></li>
            <li>
            <a href='?page={{ page_obj.paginator.num_pages }}{% for key,value in request.GET.items %}{% ifnotequal key 'page' %}&{{ key }}={{ value }}{% endifnotequal %}{% endfor %}'>{{page_obj.paginator.num_pages}}</a>
            </li>
          {% endif %}
      
        {% if page_obj.has_next %}
            <li><a href="?page={{ page_obj.next_page_number }}{% for key,value in request.GET.items %}{% ifnotequal key 'page' %}&{{ key }}={{ value }}{% endifnotequal %}{% endfor %}">&raquo;</a></li>

            
      </ul>


        {% endif %}
    </span>
</div>





{% endif %}

{% endblock content %}
